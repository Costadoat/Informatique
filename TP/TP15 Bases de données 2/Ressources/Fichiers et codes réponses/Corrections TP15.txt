Refaire l'exercice en étant plus progressif.

7.a.
SELECT P.annee, P.prenom, P.nombre from prenoms P
JOIN (select MAX(nombre) as max, annee FROM prenoms GROUP BY annee) liste_max 
ON liste_max.annee=P.annee
WHERE liste_max.max=P.nombre
ORDER BY P.annee;

7.b.
SELECT P.annee, P.prenom, P.nombre, P.sexe from prenoms P
JOIN (select MAX(nombre) as max, annee FROM prenoms WHERE sexe='F' GROUP BY annee) liste_max 
ON liste_max.annee=P.annee
WHERE liste_max.max=P.nombre AND P.sexe='F'
ORDER BY P.annee;

Il est intéressant de demander de ne pas mettre " AND P.sexe='F'" dans le WHERE de la requète globale.

7.c.
Refaire énoncé:
select prenom, somme
FROM (SELECT prenom, SUM(nombre) AS somme
FROM prenoms GROUP BY prenom) liste_somme
where liste_somme.somme=(SELECT MAX(somme) from (SELECT prenom, SUM(nombre) AS somme
FROM prenoms GROUP BY prenom) liste_somme)


